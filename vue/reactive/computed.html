<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>工作流程 | 亮神前端小册</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="亮神前端小册">
    
    <link rel="preload" href="/font-docs/assets/css/0.styles.f8f07172.css" as="style"><link rel="preload" href="/font-docs/assets/js/app.ab113d22.js" as="script"><link rel="preload" href="/font-docs/assets/js/2.a7702232.js" as="script"><link rel="preload" href="/font-docs/assets/js/39.8ddef536.js" as="script"><link rel="prefetch" href="/font-docs/assets/js/10.3d24c721.js"><link rel="prefetch" href="/font-docs/assets/js/100.b317c338.js"><link rel="prefetch" href="/font-docs/assets/js/101.b20aa33e.js"><link rel="prefetch" href="/font-docs/assets/js/102.b1f8d3b3.js"><link rel="prefetch" href="/font-docs/assets/js/103.ecb92d20.js"><link rel="prefetch" href="/font-docs/assets/js/104.59d1da3b.js"><link rel="prefetch" href="/font-docs/assets/js/105.b6bb704c.js"><link rel="prefetch" href="/font-docs/assets/js/106.32bea12f.js"><link rel="prefetch" href="/font-docs/assets/js/107.2a3c779a.js"><link rel="prefetch" href="/font-docs/assets/js/108.a28ed267.js"><link rel="prefetch" href="/font-docs/assets/js/109.e83bff13.js"><link rel="prefetch" href="/font-docs/assets/js/11.5bc93b46.js"><link rel="prefetch" href="/font-docs/assets/js/110.7fc996c2.js"><link rel="prefetch" href="/font-docs/assets/js/111.de0109d7.js"><link rel="prefetch" href="/font-docs/assets/js/112.85b9449c.js"><link rel="prefetch" href="/font-docs/assets/js/113.fc975125.js"><link rel="prefetch" href="/font-docs/assets/js/114.216bea7c.js"><link rel="prefetch" href="/font-docs/assets/js/115.090cfb62.js"><link rel="prefetch" href="/font-docs/assets/js/116.afa4d357.js"><link rel="prefetch" href="/font-docs/assets/js/117.914c90da.js"><link rel="prefetch" href="/font-docs/assets/js/118.36abb410.js"><link rel="prefetch" href="/font-docs/assets/js/119.d885fe45.js"><link rel="prefetch" href="/font-docs/assets/js/12.961a36e2.js"><link rel="prefetch" href="/font-docs/assets/js/120.54ed503a.js"><link rel="prefetch" href="/font-docs/assets/js/121.c3ea5174.js"><link rel="prefetch" href="/font-docs/assets/js/122.a623dd2a.js"><link rel="prefetch" href="/font-docs/assets/js/13.4c670e5e.js"><link rel="prefetch" href="/font-docs/assets/js/14.a1ce3775.js"><link rel="prefetch" href="/font-docs/assets/js/15.fa5a860a.js"><link rel="prefetch" href="/font-docs/assets/js/16.edacc258.js"><link rel="prefetch" href="/font-docs/assets/js/17.f8df7a8b.js"><link rel="prefetch" href="/font-docs/assets/js/18.72dcdd23.js"><link rel="prefetch" href="/font-docs/assets/js/19.706d6807.js"><link rel="prefetch" href="/font-docs/assets/js/20.108ddf67.js"><link rel="prefetch" href="/font-docs/assets/js/21.7da88a2a.js"><link rel="prefetch" href="/font-docs/assets/js/22.70a646e4.js"><link rel="prefetch" href="/font-docs/assets/js/23.c1c80ab4.js"><link rel="prefetch" href="/font-docs/assets/js/24.8be1409c.js"><link rel="prefetch" href="/font-docs/assets/js/25.dafa3760.js"><link rel="prefetch" href="/font-docs/assets/js/26.694e01e9.js"><link rel="prefetch" href="/font-docs/assets/js/27.039090e0.js"><link rel="prefetch" href="/font-docs/assets/js/28.0c94be50.js"><link rel="prefetch" href="/font-docs/assets/js/29.c32e555d.js"><link rel="prefetch" href="/font-docs/assets/js/3.c0d26cb5.js"><link rel="prefetch" href="/font-docs/assets/js/30.c9f6fdd6.js"><link rel="prefetch" href="/font-docs/assets/js/31.bcbaf1a9.js"><link rel="prefetch" href="/font-docs/assets/js/32.36213dc7.js"><link rel="prefetch" href="/font-docs/assets/js/33.f7c8afde.js"><link rel="prefetch" href="/font-docs/assets/js/34.e834e023.js"><link rel="prefetch" href="/font-docs/assets/js/35.8dda312f.js"><link rel="prefetch" href="/font-docs/assets/js/36.11df78b4.js"><link rel="prefetch" href="/font-docs/assets/js/37.15a9a489.js"><link rel="prefetch" href="/font-docs/assets/js/38.cec81ca8.js"><link rel="prefetch" href="/font-docs/assets/js/4.ea27e4cd.js"><link rel="prefetch" href="/font-docs/assets/js/40.193534f1.js"><link rel="prefetch" href="/font-docs/assets/js/41.ce1b23e7.js"><link rel="prefetch" href="/font-docs/assets/js/42.11994eef.js"><link rel="prefetch" href="/font-docs/assets/js/43.1120971d.js"><link rel="prefetch" href="/font-docs/assets/js/44.e70be40e.js"><link rel="prefetch" href="/font-docs/assets/js/45.f32091eb.js"><link rel="prefetch" href="/font-docs/assets/js/46.0470b16d.js"><link rel="prefetch" href="/font-docs/assets/js/47.f8af876b.js"><link rel="prefetch" href="/font-docs/assets/js/48.ce448fc0.js"><link rel="prefetch" href="/font-docs/assets/js/49.3c9aa3b6.js"><link rel="prefetch" href="/font-docs/assets/js/5.3099e729.js"><link rel="prefetch" href="/font-docs/assets/js/50.0247cc44.js"><link rel="prefetch" href="/font-docs/assets/js/51.edaf96f4.js"><link rel="prefetch" href="/font-docs/assets/js/52.bac5c38d.js"><link rel="prefetch" href="/font-docs/assets/js/53.9a769cc8.js"><link rel="prefetch" href="/font-docs/assets/js/54.755585b1.js"><link rel="prefetch" href="/font-docs/assets/js/55.0c0d8035.js"><link rel="prefetch" href="/font-docs/assets/js/56.906e3715.js"><link rel="prefetch" href="/font-docs/assets/js/57.6d39b791.js"><link rel="prefetch" href="/font-docs/assets/js/58.e39d5548.js"><link rel="prefetch" href="/font-docs/assets/js/59.9a4436d4.js"><link rel="prefetch" href="/font-docs/assets/js/6.fa3b5319.js"><link rel="prefetch" href="/font-docs/assets/js/60.db97d3d4.js"><link rel="prefetch" href="/font-docs/assets/js/61.63ebb788.js"><link rel="prefetch" href="/font-docs/assets/js/62.2e1642b4.js"><link rel="prefetch" href="/font-docs/assets/js/63.404afa47.js"><link rel="prefetch" href="/font-docs/assets/js/64.3fc9bd1a.js"><link rel="prefetch" href="/font-docs/assets/js/65.087359aa.js"><link rel="prefetch" href="/font-docs/assets/js/66.0e1dbfa1.js"><link rel="prefetch" href="/font-docs/assets/js/67.f5508703.js"><link rel="prefetch" href="/font-docs/assets/js/68.063a4309.js"><link rel="prefetch" href="/font-docs/assets/js/69.e003c953.js"><link rel="prefetch" href="/font-docs/assets/js/7.8f66f4e3.js"><link rel="prefetch" href="/font-docs/assets/js/70.db533f79.js"><link rel="prefetch" href="/font-docs/assets/js/71.f5adc2fe.js"><link rel="prefetch" href="/font-docs/assets/js/72.c77d8ceb.js"><link rel="prefetch" href="/font-docs/assets/js/73.53bb4c8a.js"><link rel="prefetch" href="/font-docs/assets/js/74.fa982014.js"><link rel="prefetch" href="/font-docs/assets/js/75.ebc912b8.js"><link rel="prefetch" href="/font-docs/assets/js/76.360b896f.js"><link rel="prefetch" href="/font-docs/assets/js/77.09e34fb3.js"><link rel="prefetch" href="/font-docs/assets/js/78.e51a0adc.js"><link rel="prefetch" href="/font-docs/assets/js/79.0d18c5fd.js"><link rel="prefetch" href="/font-docs/assets/js/8.91fc3f7b.js"><link rel="prefetch" href="/font-docs/assets/js/80.19046804.js"><link rel="prefetch" href="/font-docs/assets/js/81.86b61c9b.js"><link rel="prefetch" href="/font-docs/assets/js/82.e3b85ba1.js"><link rel="prefetch" href="/font-docs/assets/js/83.2e228169.js"><link rel="prefetch" href="/font-docs/assets/js/84.3c6de565.js"><link rel="prefetch" href="/font-docs/assets/js/85.195aa246.js"><link rel="prefetch" href="/font-docs/assets/js/86.9592c42a.js"><link rel="prefetch" href="/font-docs/assets/js/87.4f35105c.js"><link rel="prefetch" href="/font-docs/assets/js/88.3eb20e04.js"><link rel="prefetch" href="/font-docs/assets/js/89.aa1241cf.js"><link rel="prefetch" href="/font-docs/assets/js/9.c2c6aed5.js"><link rel="prefetch" href="/font-docs/assets/js/90.097b16ac.js"><link rel="prefetch" href="/font-docs/assets/js/91.bcc1349e.js"><link rel="prefetch" href="/font-docs/assets/js/92.3b8c2727.js"><link rel="prefetch" href="/font-docs/assets/js/93.2ef6a5d8.js"><link rel="prefetch" href="/font-docs/assets/js/94.5d8072d4.js"><link rel="prefetch" href="/font-docs/assets/js/95.7e6d60ea.js"><link rel="prefetch" href="/font-docs/assets/js/96.2f7249dc.js"><link rel="prefetch" href="/font-docs/assets/js/97.bc860a09.js"><link rel="prefetch" href="/font-docs/assets/js/98.c48a9f29.js"><link rel="prefetch" href="/font-docs/assets/js/99.7f628413.js">
    <link rel="stylesheet" href="/font-docs/assets/css/0.styles.f8f07172.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/font-docs/" class="home-link router-link-active"><!----> <span class="site-name">亮神前端小册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/font-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/font-docs/basic/basic/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/font-docs/css/" class="nav-link">
  css
</a></div><div class="nav-item"><a href="/font-docs/browser/theory/" class="nav-link">
  浏览器相关
</a></div><div class="nav-item"><a href="/font-docs/nodejs/" class="nav-link">
  nodejs
</a></div><div class="nav-item"><a href="/font-docs/babel/" class="nav-link">
  babel
</a></div><div class="nav-item"><a href="/font-docs/buildTools/webpack/" class="nav-link">
  打包工具
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/font-docs/vue/reactive/" class="nav-link router-link-active">
  响应式
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/compiler/" class="nav-link">
  模版编译
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/vnode/" class="nav-link">
  虚拟DOM
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/whole-process/" class="nav-link">
  整体流程
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/vuex/" class="nav-link">
  Vuex&amp;Vue-router
</a></li></ul></div></div><div class="nav-item"><a href="/font-docs/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><a href="/font-docs/code-reviews/" class="nav-link">
  LC
</a></div><div class="nav-item"><a href="/font-docs/project/B/batch_download.html" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/font-docs/news/vue3.html" class="nav-link">
  前沿
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/utils-library/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  公共函数库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/h5-sdk/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  h5-sdk
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/h5_template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端多页面模版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/zcl-mobile-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端组件库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://gitlab.61info.com:8190/zcl/tpc-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zcl脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/0zcl" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/font-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/font-docs/basic/basic/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/font-docs/css/" class="nav-link">
  css
</a></div><div class="nav-item"><a href="/font-docs/browser/theory/" class="nav-link">
  浏览器相关
</a></div><div class="nav-item"><a href="/font-docs/nodejs/" class="nav-link">
  nodejs
</a></div><div class="nav-item"><a href="/font-docs/babel/" class="nav-link">
  babel
</a></div><div class="nav-item"><a href="/font-docs/buildTools/webpack/" class="nav-link">
  打包工具
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/font-docs/vue/reactive/" class="nav-link router-link-active">
  响应式
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/compiler/" class="nav-link">
  模版编译
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/vnode/" class="nav-link">
  虚拟DOM
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/whole-process/" class="nav-link">
  整体流程
</a></li><li class="dropdown-item"><!----> <a href="/font-docs/vue/vuex/" class="nav-link">
  Vuex&amp;Vue-router
</a></li></ul></div></div><div class="nav-item"><a href="/font-docs/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><a href="/font-docs/code-reviews/" class="nav-link">
  LC
</a></div><div class="nav-item"><a href="/font-docs/project/B/batch_download.html" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/font-docs/news/vue3.html" class="nav-link">
  前沿
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/utils-library/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  公共函数库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/h5-sdk/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  h5-sdk
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/h5_template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端多页面模版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/zcl-mobile-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端组件库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://gitlab.61info.com:8190/zcl/tpc-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zcl脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/0zcl" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>响应式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/font-docs/vue/reactive/" class="sidebar-heading clickable router-link-active open"><span>响应式</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-docs/vue/reactive/" aria-current="page" class="sidebar-link">MVVM概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/#什么mvc" class="sidebar-link">什么MVC？</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/#谈谈对mvvm的理解" class="sidebar-link">谈谈对MVVM的理解？</a></li></ul></li><li><a href="/font-docs/vue/reactive/reactive.html" class="sidebar-link">响应式原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/reactive.html#响应式原理" class="sidebar-link">响应式原理</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/reactive.html#核心角色" class="sidebar-link">核心角色</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/reactive.html#核心代码" class="sidebar-link">核心代码</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/reactive.html#响应式对数组是如何处理" class="sidebar-link">响应式对数组是如何处理</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/reactive.html#面试" class="sidebar-link">面试</a></li></ul></li><li><a href="/font-docs/vue/reactive/nextTick.html" class="sidebar-link">nextTick原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/nextTick.html#mutationobserver" class="sidebar-link">MutationObserver</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/nextTick.html#nexttick码源解读" class="sidebar-link">nextTick码源解读</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/nextTick.html#vue异步更新队列" class="sidebar-link">Vue异步更新队列</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/nextTick.html#异步更新源码解读" class="sidebar-link">异步更新源码解读</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/nextTick.html#面试" class="sidebar-link">面试</a></li></ul></li><li><a href="/font-docs/vue/reactive/watch.html" class="sidebar-link">watch原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/watch.html#工作流程" class="sidebar-link">工作流程</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/watch.html#依赖收集" class="sidebar-link">依赖收集</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/watch.html#更新" class="sidebar-link">更新</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/watch.html#卸载监听" class="sidebar-link">卸载监听</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/watch.html#面试" class="sidebar-link">面试</a></li></ul></li><li><a href="/font-docs/vue/reactive/computed.html" aria-current="page" class="active sidebar-link">computed原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/computed.html#工作流程" class="sidebar-link">工作流程</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/computed.html#computed缓存" class="sidebar-link">computed缓存</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/computed.html#核心代码" class="sidebar-link">核心代码</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/computed.html#依赖收集" class="sidebar-link">依赖收集</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/computed.html#依赖依集总结" class="sidebar-link">依赖依集总结</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/computed.html#面试" class="sidebar-link">面试</a></li></ul></li><li><a href="/font-docs/vue/reactive/interview.html" class="sidebar-link">面试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/interview.html#组件里的-data-必须是一个函数返回的对象-而不能就只是一个对象" class="sidebar-link">组件里的 data 必须是一个函数返回的对象，而不能就只是一个对象?</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/interview.html#proxy代理" class="sidebar-link">proxy代理</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/interview.html#vue-中的-key-有什么用" class="sidebar-link">Vue 中的 key 有什么用?</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/interview.html#v-model原理" class="sidebar-link">v-model原理</a></li><li class="sidebar-sub-header"><a href="/font-docs/vue/reactive/interview.html#sync修饰符原理" class="sidebar-link">.sync修饰符原理</a></li></ul></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="工作流程"><a href="#工作流程" class="header-anchor">#</a> 工作流程</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>fullName<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    firstName<span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
    lastName<span class="token operator">:</span> <span class="token string">'last'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 计算属性的 getter</span>
    <span class="token function">fullName</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// `this` 指向 vm 实例</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">Tips</p> <p>温馨提示：computed 内使用的 data 属性，下文统称为“依赖属性”</p></div> <p>入口文件: /src/core/instance/index.js调用了<code>initMixin(Vue)</code>  -&gt; /src/core/instance/init.js 调用了<code>initState(vm)</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 源码位置: /src/core/instance/state.js </span>
<span class="token keyword">function</span> <span class="token function">initState</span> <span class="token punctuation">(</span><span class="token parameter">vm<span class="token operator">:</span> Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">.</span>_watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> opts <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options
  <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token function">initProps</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>props<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>methods<span class="token punctuation">)</span> <span class="token function">initMethods</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>methods<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initData</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* asRootData */</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 初始化 computed</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token function">initComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>computed<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>watch <span class="token operator">&amp;&amp;</span> opts<span class="token punctuation">.</span>watch <span class="token operator">!==</span> nativeWatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initWatch</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>watch<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>initComputed</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 源码位置：/src/core/instance/state.js </span>
<span class="token keyword">function</span> <span class="token function">initComputed</span> <span class="token punctuation">(</span><span class="token parameter">vm<span class="token operator">:</span> Component<span class="token punctuation">,</span> computed<span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1</span>
  <span class="token keyword">const</span> watchers <span class="token operator">=</span> vm<span class="token punctuation">.</span>_computedWatchers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userDef <span class="token operator">=</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token comment">// 2</span>
    <span class="token keyword">const</span> getter <span class="token operator">=</span> <span class="token keyword">typeof</span> userDef <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> userDef <span class="token operator">:</span> userDef<span class="token punctuation">.</span>get

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSSR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 3</span>
      watchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>
        vm<span class="token punctuation">,</span>
        getter <span class="token operator">||</span> noop<span class="token punctuation">,</span>
        noop<span class="token punctuation">,</span>
        <span class="token punctuation">{</span> lazy<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 4</span>
      <span class="token function">defineComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> userDef<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><ul><li>实例上定义 _computedWatchers 对象，用于存储“计算属性Watcher”</li> <li>获取计算属性的 getter，需要判断是函数声明还是对象声明</li> <li>创建<code>计算属性watcher</code>实例，getter 作为参数传入，它会在依赖属性更新时进行调用，并对计算属性重新取值。这部分下面会讲</li> <li>defineComputed 对计算属性进行数据劫持</li></ul> <p>defineComputed如何对计算属性做数据劫持?</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 源码位置：/src/core/instance/state.js </span>
<span class="token keyword">const</span> <span class="token function-variable function">noop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 1</span>
<span class="token keyword">const</span> sharedPropertyDefinition <span class="token operator">=</span> <span class="token punctuation">{</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  get<span class="token operator">:</span> noop<span class="token punctuation">,</span>
  set<span class="token operator">:</span> noop
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">defineComputed</span> <span class="token punctuation">(</span>
  <span class="token parameter">target<span class="token operator">:</span> any<span class="token punctuation">,</span>
  key<span class="token operator">:</span> string<span class="token punctuation">,</span>
  userDef<span class="token operator">:</span> Object <span class="token operator">|</span> Function</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断是否为服务端渲染</span>
  <span class="token keyword">const</span> shouldCache <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">isServerRendering</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> userDef <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2</span>
    sharedPropertyDefinition<span class="token punctuation">.</span>get <span class="token operator">=</span> shouldCache
      <span class="token operator">?</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token function">createGetterInvoker</span><span class="token punctuation">(</span>userDef<span class="token punctuation">)</span>
    sharedPropertyDefinition<span class="token punctuation">.</span>set <span class="token operator">=</span> noop
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2</span>
    sharedPropertyDefinition<span class="token punctuation">.</span>get <span class="token operator">=</span> userDef<span class="token punctuation">.</span>get
      <span class="token operator">?</span> shouldCache <span class="token operator">&amp;&amp;</span> userDef<span class="token punctuation">.</span>cache <span class="token operator">!==</span> <span class="token boolean">false</span>
        <span class="token operator">?</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token function">createGetterInvoker</span><span class="token punctuation">(</span>userDef<span class="token punctuation">.</span>get<span class="token punctuation">)</span>
      <span class="token operator">:</span> noop
    sharedPropertyDefinition<span class="token punctuation">.</span>set <span class="token operator">=</span> userDef<span class="token punctuation">.</span>set <span class="token operator">||</span> noop
  <span class="token punctuation">}</span>
  <span class="token comment">// 3</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> sharedPropertyDefinition<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><ol><li>sharedPropertyDefinition 是计算属性初始的属性描述对象</li> <li>计算属性使用 <code>函数声明</code> 或 <code>对象声明</code>, (浏览器环境)执行createComputedGetter返回的函数 赋值的 defineProperty.get</li> <li>对计算属性进行数据劫持，sharedPropertyDefinition 作为第三个给参数传入</li></ol> <p>下面看看 createComputedGetter 的实现</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 源码位置：/src/core/instance/state.js</span>
<span class="token keyword">function</span> <span class="token function">createComputedGetter</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1</span>
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 2</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 3</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 4</span>
      <span class="token keyword">return</span> watcher<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ol><li>取出对应的“计算属性Watcher</li> <li>watcher.dirty 是实现计算属性缓存的触发点，当watcher.dirty为true时, 才会执行watcher.evaluate 对计算属性重新求值</li> <li>依赖属性收集<code>渲染watcher</code>
第3点, 为什么依赖属性收集 render watcher? 这个下面会解释</li></ol> <h2 id="computed缓存"><a href="#computed缓存" class="header-anchor">#</a> computed缓存</h2> <p>在创建 computed watcher 的时候, lazy为true, dirty 的初始值等同于 lazy</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>
    vm<span class="token punctuation">,</span>
    getter <span class="token operator">||</span> noop<span class="token punctuation">,</span>
    noop<span class="token punctuation">,</span>
    <span class="token punctuation">{</span> lazy<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>也就是说, 在初始化computed中, 会实例化computed watcher, 实例化后的computed watcher 的lazy属性为true, 所以此时watcher.value 为 undefined</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span>
    <span class="token parameter">vm<span class="token operator">:</span> Component<span class="token punctuation">,</span>
    expOrFn<span class="token operator">:</span> string <span class="token operator">|</span> Function<span class="token punctuation">,</span>
    cb<span class="token operator">:</span> Function<span class="token punctuation">,</span>
    options<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span>
    isRenderWatcher<span class="token operator">?</span><span class="token operator">:</span> boolean</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ......</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>lazy <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>lazy
    <span class="token comment">// dirty 初始值等同于 lazy</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lazy <span class="token comment">// for lazy watchers</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lazy
      <span class="token operator">?</span> <span class="token keyword">undefined</span>
      <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>初始化computed结束后, 会执行$mount, 初始化渲染界面. 以文章开头的例子, 初始化渲染界面时, 由于使用到了<code>fullname</code>, 触发 computed <code>数据劫持get</code>. 前面已经讲过, 计算属性进行数据劫持get 实际上是 执行computedGetter函数.</p> <h2 id="核心代码"><a href="#核心代码" class="header-anchor">#</a> 核心代码</h2> <p>再来看下核心代码吧!</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createComputedGetter</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> watcher<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// .....</span>
<span class="token keyword">function</span> <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>执行computedGetter函数, 由于实例化的computed watcher.dirty为true, 所以会执行watcher.evaluate(), evaluate做了两件事</p> <ul><li>调用this.get(), 即执行computed函数, 将结果赋值给watcher.value</li> <li>将watcher.dirty 置为 false. 下次再获取计算属性时, 就无需再次执行evaluate, 只需直接返回缓存的watcher.value.</li></ul> <div class="custom-block tip"><p class="custom-block-title">Tips</p> <p>虽然watcher.dirty置为 false, 但watcher.lazy 还是 true</p></div> <h2 id="依赖收集"><a href="#依赖收集" class="header-anchor">#</a> 依赖收集</h2> <p>上面讲了, 为了将结果缓存到watcher.value, 需要调用this.get(), 即执行computed函数. 然而执行computed函数时, 可不是那么简单! computed函数会获取 <code>依赖属性</code>, 触发 数据劫持get. 那么初始化渲染界面后, computed 依赖属性 对应的 dep队列 有几个watcher? 分别是什么? 下面我们来分析一下</p> <p>想搞清楚依赖收集, 必须要知道Dep.target(即watcher实例), dep分别是啥! 才能把watcher实例放入属性对应的dep队列中.</p> <h3 id="收集计算属性watcher"><a href="#收集计算属性watcher" class="header-anchor">#</a> 收集计算属性Watcher</h3> <p>其实this.get()函数中, 调用pushTarget()就把当前的watcher入栈, 并赋值给Dep.target.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">// 存储 watcher 的栈</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">pushTarget</span><span class="token punctuation">(</span><span class="token parameter">watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 入栈</span>
  stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
  Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> watcher
<span class="token punctuation">}</span> 

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">popTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 出栈</span>
  stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> stack<span class="token punctuation">[</span>stack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>在界面初始化时, 具体来说是$beforeMount之后, $mounted之前, 会实例化 <code>渲染watcher</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mountComponent</span> <span class="token punctuation">(</span>
  <span class="token parameter">vm<span class="token punctuation">,</span>
  el<span class="token punctuation">,</span>
  hydrating</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> updateComponent<span class="token punctuation">;</span>

  <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 渲染页面</span>
    vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">before</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">before</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_isMounted <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>vm<span class="token punctuation">.</span>_isDestroyed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* isRenderWatcher */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  hydrating <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$vnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span>_isMounted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'mounted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> vm
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>此时, 先将<code>渲染watcher</code>入栈, 并赋值给<code>Dep.target</code>
在页面渲染过程中遇到计算属性，对其取值，因此执行 watcher.evaluate 的逻辑，接着调用 this.get</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1</span>
  <span class="token function">pushTarget</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> value
  <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm
  value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> vm<span class="token punctuation">)</span> <span class="token comment">// 计算属性求值</span>
  <span class="token function">popTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cleanupDeps</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> value
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>pushTarget 轮到“计算属性Watcher”入栈，并挂载到Dep.target，此时<strong>栈中为 [渲染Watcher, 计算属性Watcher]</strong></p> <p>this.getter 对计算属性求值，在获取依赖属性时，会触发依赖属性的 <code>数据劫持get</code>，执行 dep.depend 收集依赖（“计算属性Watcher”）, 此时<code>依赖属性 对应的dep队列 [计算属性Watcher]</code></p> <h3 id="收集渲染watcher"><a href="#收集渲染watcher" class="header-anchor">#</a> 收集渲染Watcher</h3> <p>this.getter 求值完成执行<code>popTragte</code>，“计算属性Watcher”出栈，Dep.target 设置为“渲染Watcher”，此时的 Dep.target 是“渲染Watcher”
在核心代码中, 有如下代码:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>watcher.depend 将 当前watcher, 即Dep.target, 即渲染watcher. 放入依赖属性的 dep队列中. 此时<code>依赖属性 对应的dep队列 [计算属性Watcher, 渲染watcher]</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// deps 内存储的是依赖属性的 dep</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>deps<span class="token punctuation">.</span>length
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/font-docs/assets/img/5.2d531fc0.png" alt="deps"></p> <h3 id="为什么依赖属性要收集渲染watcher"><a href="#为什么依赖属性要收集渲染watcher" class="header-anchor">#</a> 为什么依赖属性要收集渲染Watcher</h3> <p>模板上没有使用到依赖属性，页面渲染时，那么依赖属性是不会收集 “渲染Watcher”的。此时依赖属性里只会有“计算属性Watcher”，当依赖属性被修改，只会触发“计算属性Watcher”的 update。而计算属性的 update 里仅仅是将 dirty 设置为 true，并没有立刻求值，那么计算属性也不会被更新。</p> <p>所以需要收集“渲染Watcher”，在执行完“计算属性Watcher”后，再执行“渲染Watcher”。页面渲染对计算属性取值，执行 watcher.evaluate 才会重新计算求值，页面计算属性更新</p> <h2 id="依赖依集总结"><a href="#依赖依集总结" class="header-anchor">#</a> 依赖依集总结</h2> <p><img src="/font-docs/assets/img/6.e490b3d4.png" alt="deps"></p> <p>依赖属性的dep队列至少会有两个watcher[计算属性Watcher, 渲染watcher]</p> <h2 id="面试"><a href="#面试" class="header-anchor">#</a> 面试</h2> <ol><li>computed是如何初始化的, 初始化之后做了那些事情?</li></ol> <p>答:</p> <ul><li>实例化computed watcher, 将computed watcher存入vm._computedWatchers 对象中. 初始化时watcher.dirty为true</li> <li>通过defineProperty 对computed属性 做数据劫持</li> <li>界面渲染时, 获取computed属性, 触发数据劫持get, 由于watcher.dirty为true, 会执行computed函数</li></ul> <ol start="2"><li>为什么我们改变了data中的属性值后, computed会重新计算, 它是如何实现的?
修改了依赖属性, computed会重新计算.
依赖收集:</li></ol> <ul><li>依赖属性对应的dep队列[计算属性Watcher]. 页面渲染获取computed属性时, 会执行computed函数. 触发了依赖属性 数据劫持get, 将computed watcher 放入 依赖属性对应的dep队列</li> <li>依赖属性对应的dep队列[计算属性Watcher, 渲染watcher]. computed中执行watcher.depend. 将渲染watcher放入 依赖属性的dep队列
总之, computed在页面渲染之后, 依赖属性的dep队列至少会有两个watcher[计算属性Watcher, 渲染watcher]</li></ul> <p>当依赖属性变化时, 先执行计算属性Watcher 的update, 将watcher.dirty置为true, 表示需要重新计算.  接着执行渲染watcher 的update回调, 页面渲染对computed 属性取值, 由于computed watcher.dirty为true, 会执行computed watcher.evaluate重新计算求值
<img src="data:image/png;base64,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" alt="dirty"></p> <ol start="3"><li>computed它是如何缓存值的, 当我们下次访问该属性的时候, 是怎样读取缓存数据的?
通过computed watcher.dirty控制是否使用缓存</li></ol> <p>将缓存结果赋值给 computed watcher.value</p> <ul><li>dirty为true: 重新计算, 更新watcher.value</li> <li>dirty为false: 使用缓存, 直接返回</li></ul> <p>参考:
<a href="https://mp.weixin.qq.com/s?__biz=MzUxNjQ1NjMwNw==&amp;mid=2247484234&amp;idx=1&amp;sn=70a9dea79d5f1b5aaacbe828fa5815e1&amp;chksm=f9a66956ced1e0407f5ac7a3722f9784327b121763e73de9011b4fcb852d530d44632717021c&amp;cur_album_id=1619085427984957440&amp;scene=190#rd" target="_blank" rel="noopener noreferrer">Computed - 源码版<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.cnblogs.com/chanwahfung/p/13193897.html" target="_blank" rel="noopener noreferrer">手摸手带你理解Vue的Computed原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/31/2021, 9:21:34 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/font-docs/vue/reactive/watch.html" class="prev">
        watch原理
      </a></span> <span class="next"><a href="/font-docs/vue/reactive/interview.html">
        面试
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/font-docs/assets/js/app.ab113d22.js" defer></script><script src="/font-docs/assets/js/2.a7702232.js" defer></script><script src="/font-docs/assets/js/39.8ddef536.js" defer></script>
  </body>
</html>
